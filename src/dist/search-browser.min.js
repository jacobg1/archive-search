!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("archiveSearch",[],t):"object"==typeof exports?exports.archiveSearch=t():e.archiveSearch=t()}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=r(1),c=r(2),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.searchBaseUrl="https://archive.org/advancedsearch.php",this.searchDefaults=c,this.searchBy="creator",this.metaBaseUrl="https://archive.org/metadata/"}var t,r,i;return t=e,i=[{key:"setSortBy",value:function(e){var t="";return Object.keys(e).forEach((function(r){t+="&sort[]=".concat(r,"+").concat(e[r])})),encodeURI(t)}},{key:"jsonp",value:function(e,t){var r="jsonp_callback_".concat(Math.round(15e4*Math.random()));window[r]=function(e){t(e),delete window[r],document.body.removeChild(n)};var n=document.createElement("script");n.src="".concat(e+(e.indexOf("?")>=0?"&":"?"),"callback=").concat(r),n.onerror=function(){throw new Error("Bad request, check query params")},document.body.appendChild(n)}},{key:"makeSearch",value:function(e){var t=this;return new Promise((function(r){t.jsonp(e,(function(e){var t=e.response,n=t.numFound,o=t.docs;if(0===n)throw new Error("no results, please update query params");r(o)}))}))}}],(r=[{key:"setOptions",value:function(e){var t=this;if(!a.isObject(e))throw new TypeError("setOptions() expected an Object");var r=["fields","max","sortBy","searchBy"];if(Object.keys(e).forEach((function(e){if(-1===r.indexOf(e))throw new Error("Invalid syntax for options check field: ".concat(e))})),!a.isArray(e.fields))throw new Error("Invalid syntax for options");this.searchDefaults=encodeURI("&fl[]=identifier");var n=e.fields,o=e.sortBy,c=e.max,i=e.searchBy;n.forEach((function(e){t.searchDefaults+=encodeURI("&fl[]=".concat(e))})),o&&(this.searchDefaults+=this.constructor.setSortBy(o)),c&&(this.searchDefaults+="&rows=".concat(c,"&page=")),i&&(this.searchBy=i),this.searchDefaults+="&output=json"}},{key:"constructSearchUrl",value:function(e,t){return"".concat(this.searchBaseUrl,"?q=").concat(e,"%3A").concat(t).concat(this.searchDefaults)}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!a.isString(e))throw new TypeError("search() expected a string");0!==t.length&&this.setOptions(t);var r=e.replace(/\s+/g,"+").toLowerCase(),n=this.constructSearchUrl(this.searchBy,r);return this.constructor.makeSearch(n)}},{key:"metaSearch",value:function(e){var t=this,r="".concat(this.metaBaseUrl).concat(e);return new Promise((function(e){t.constructor.jsonp(r,(function(t){var r=t.files,o=t.server,a=t.dir,c={metadata:t.metadata,reviews:t.reviews,files:[]};Object.keys(r).forEach((function(e){var t=r[e],i=t.format,s=t.name;"Metadata"!==i&&"JSON"!==i&&c.files.push(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){n(e,t,r[t])}))}return e}({},r[e],{name:s,format:i,link:"https://".concat(o).concat(a,"/").concat(s.replace(/ /g,"%20"))}))})),e(c)}))}))}}])&&o(t.prototype,r),i&&o(t,i),e}(),s=new i;e.exports={archiveSearch:s,Search:i}},function(e,t){e.exports={isString:function(e){return"[object String]"===Object.prototype.toString.call(e)},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isObject:function(e){return"[object Object]"===Object.prototype.toString.call(e)}}},function(e,t){e.exports="&fl%5B%5D=year&fl%5B%5D=title&fl%5B%5D=mediatype&fl%5B%5D=language&fl%5B%5D=date&fl%5B%5D=downloads&fl%5B%5D=creator&&fl%5B%5D=identifier&sort%5B%5D=year+asc&sort%5B%5D=downloads+asc&rows=150&page=1&output=json"}])}));